<h1 id='webhooks'>Webhooks</h1><h2 id='webhooks-create'>Create</h2>
<blockquote>
<p>Example Request:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST https://api.transferwise.com/v1/subscriptions/ <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer &lt;your api token&gt;"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{
       "name": "Webhook Subscription #1",
       "channel_id": "WEBHOOK",
       "callback_url": "&lt;URL of your server&gt;",
       "profile_id": &lt;ID of the profile you want to receive notifications from&gt;,
       "enabled_notifications": ["transfers", "balance"]
      }'</span>
</code></pre>
<blockquote>
<p>Example Response:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abcde123-abcd-abcd-abcd-abcde1234567"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Webhook Subscription #1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"channel_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WEBHOOK"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TW::&lt;your user ID&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ENABLED"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-03-10T09:32:15.663Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;URL of your server&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"profile_id"</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;ID</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">profile</span><span class="w"> </span><span class="err">you</span><span class="w"> </span><span class="err">want</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">receive</span><span class="w"> </span><span class="err">notifications</span><span class="w"> </span><span class="err">from&gt;</span><span class="p">,</span><span class="w">
  </span><span class="s2">"enabled_notifications"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"balance"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"transfers"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Webhook subscription is a mechanism that will allow you to receive notifications to your servers whenever your transfers and/or balance get updated.</p>

<p>Before proceeding, make sure the endpoint where you intend to receive webhooks satisfies the following requirements:</p>

<ul>
<li>Has a valid domain name (IP-s are not allowed)</li>
<li>Listens to HTTPS requests on port <code>443</code></li>
<li>Has a valid HTTPS certificate signed by a trusted CA (self-signed or expired certificates are not accepted)</li>
<li>Does not include any query arguments in the URI</li>
</ul>

<p><code>https://webhooks.example.com/balance-change</code> is a valid URL; <code>http://webhooks.example.com:8080/hook.php?type=balance</code> is not.</p>

<p>Currently we are delivering all notifications and <code>enabled_notifications</code> criteria will not be taken into account.</p>

<p><strong>NB! Please note this feature is not available in sandbox environment.</strong></p>
<h3 id='webhooks-create-request'>Request</h3>
<p><strong><code>POST https://api.transferwise.com/v1/subscriptions</code></strong></p>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Format</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>Custom name of your webhook</td>
<td>String</td>
</tr>
<tr>
<td>channel_id</td>
<td>ID of the channel through which you&#39;re receiving notifications, always equal to <code>WEBHOOK</code></td>
<td>String</td>
</tr>
<tr>
<td>callback_url</td>
<td>URL of your server</td>
<td>String</td>
</tr>
<tr>
<td>profile_id</td>
<td>ID of the profile you want to receive notifications from</td>
<td>Integer</td>
</tr>
<tr>
<td>enabled_notifications</td>
<td>List of resources you would like to receive notifications about</td>
<td>[String]</td>
</tr>
</tbody></table>
<h3 id='webhooks-create-response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Format</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Subscription ID</td>
<td>UUID</td>
</tr>
<tr>
<td>name</td>
<td>Custom name of your webhook</td>
<td>String</td>
</tr>
<tr>
<td>channel_id</td>
<td>ID of the channel through which you&#39;re receiving notifications, always equal to <code>WEBHOOK</code></td>
<td>String</td>
</tr>
<tr>
<td>user_id</td>
<td>Your user ID</td>
<td>Integer</td>
</tr>
<tr>
<td>status</td>
<td>Status of the subscription</td>
<td>String</td>
</tr>
<tr>
<td>created_on</td>
<td>Timestamp when subscription was created</td>
<td>Timestamp</td>
</tr>
<tr>
<td>url</td>
<td>URL of your server</td>
<td>String</td>
</tr>
<tr>
<td>profile_id</td>
<td>ID of the profile you want to receive notifications from</td>
<td>Integer</td>
</tr>
<tr>
<td>enabled_notifications</td>
<td>List of resources you would like to receive notifications about</td>
<td>[String]</td>
</tr>
</tbody></table>
<h2 id='webhooks-list'>List</h2>
<blockquote>
<p>Example Request:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET https://api.transferwise.com/v1/subscriptions?channelId<span class="o">=</span>webhook <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer &lt;your api token&gt;"</span>
</code></pre>
<blockquote>
<p>Example Response:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abcde123-abcd-abcd-abcd-abcde1234567"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Webhook Subscription #1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"channel_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WEBHOOK"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TW::&lt;your user ID&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ENABLED"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-03-10T09:32:15.663Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;URL of your server&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"profile_id"</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;ID</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">profile</span><span class="w"> </span><span class="err">you</span><span class="w"> </span><span class="err">want</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">receive</span><span class="w"> </span><span class="err">notifications</span><span class="w"> </span><span class="err">from&gt;</span><span class="p">,</span><span class="w">
    </span><span class="s2">"enabled_notifications"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"balance"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abcde123-abcd-abcd-abcd-abcde1234568"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Webhook Subscription #2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"channel_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WEBHOOK"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TW::&lt;your user ID&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ENABLED"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-03-11T09:32:15.663Z"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;URL of your server&gt;"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"profile_id"</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;ID</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">profile</span><span class="w"> </span><span class="err">you</span><span class="w"> </span><span class="err">want</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">receive</span><span class="w"> </span><span class="err">notifications</span><span class="w"> </span><span class="err">from&gt;</span><span class="p">,</span><span class="w">
    </span><span class="s2">"enabled_notifications"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"transfers"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p>List all created webhook subscriptions.</p>
<h3 id='webhooks-list-response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Format</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Subscription ID</td>
<td>UUID</td>
</tr>
<tr>
<td>name</td>
<td>Custom name of your webhook</td>
<td>String</td>
</tr>
<tr>
<td>channel_id</td>
<td>ID of the channel through which you&#39;re receiving notifications, always equal to <code>WEBHOOK</code></td>
<td>String</td>
</tr>
<tr>
<td>user_id</td>
<td>Your user ID</td>
<td>Integer</td>
</tr>
<tr>
<td>status</td>
<td>Status of the subscription</td>
<td>String</td>
</tr>
<tr>
<td>created_on</td>
<td>Timestamp when subscription was created</td>
<td>Timestamp</td>
</tr>
<tr>
<td>url</td>
<td>URL of your server</td>
<td>String</td>
</tr>
<tr>
<td>profile_id</td>
<td>ID of the profile you want to receive notifications from</td>
<td>Integer</td>
</tr>
<tr>
<td>enabled_notifications</td>
<td>List of resources you would like to receive notifications about</td>
<td>[String]</td>
</tr>
</tbody></table>
<h2 id='webhooks-get-by-id'>Get by ID</h2>
<blockquote>
<p>Example Request:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET https://api.transferwise.com/v1/subscriptions/<span class="o">{</span>subscriptionId<span class="o">}</span>/ <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer &lt;your api token&gt;"</span>
</code></pre>
<blockquote>
<p>Example Response:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abcde123-abcd-abcd-abcd-abcde1234567"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Webhook Subscription #1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"channel_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WEBHOOK"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TW::&lt;your user ID&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ENABLED"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"created_on"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-03-10T09:32:15.663Z"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;URL of your server&gt;"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"profile_id"</span><span class="p">:</span><span class="w"> </span><span class="err">&lt;ID</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">profile</span><span class="w"> </span><span class="err">you</span><span class="w"> </span><span class="err">want</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">receive</span><span class="w"> </span><span class="err">notifications</span><span class="w"> </span><span class="err">from&gt;</span><span class="p">,</span><span class="w">
  </span><span class="s2">"enabled_notifications"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"balance"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"transfers"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Get subscription information by ID.</p>
<h3 id='webhooks-get-by-id-response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Format</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Subscription ID</td>
<td>UUID</td>
</tr>
<tr>
<td>name</td>
<td>Custom name of your webhook</td>
<td>String</td>
</tr>
<tr>
<td>channel_id</td>
<td>ID of the channel through which you&#39;re receiving notifications, always equal to <code>WEBHOOK</code></td>
<td>String</td>
</tr>
<tr>
<td>user_id</td>
<td>Your user ID</td>
<td>Integer</td>
</tr>
<tr>
<td>status</td>
<td>Status of the subscription</td>
<td>String</td>
</tr>
<tr>
<td>created_on</td>
<td>Timestamp when subscription was created</td>
<td>Date</td>
</tr>
<tr>
<td>url</td>
<td>URL of your server</td>
<td>String</td>
</tr>
<tr>
<td>profile_id</td>
<td>ID of the profile you want to receive notifications from</td>
<td>Integer</td>
</tr>
<tr>
<td>enabled_notifications</td>
<td>List of resources you would like to receive notifications about</td>
<td>[String]</td>
</tr>
</tbody></table>
<h2 id='webhooks-deactivate'>Deactivate</h2>
<blockquote>
<p>Example Request:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X DELETE https://api.transferwise.com/v1/subscriptions/<span class="o">{</span>subscriptionId<span class="o">}</span>/ <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer &lt;your api token&gt;"</span>
</code></pre>
<blockquote>
<p>Example Response:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="o">{</span>
<span class="o">}</span>
</code></pre>
<p>Deactivate a subscription.</p>
<h1 id='events'>Events</h1>
<p>Events will not contain any personally identifiable information.</p>

<p>In case first delivery attempt fails, we will try to resend it 3 times consequently.</p>
<h2 id='events-test-event'>Test event</h2>
<blockquote>
<p>Example Request:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST https://api.transferwise.com/v1/webhooks/ping <span class="se">\</span>
  -H <span class="s2">"Authorization: Bearer &lt;your api token&gt;"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{
       "callback_url": "&lt;URL of your server&gt;"
      }'</span>
</code></pre>
<blockquote>
<p>Example Response:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SUCCESS"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
  </span><span class="s2">"elapsed"</span><span class="p">:</span><span class="w"> </span><span class="mi">228</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>You can trigger a test event to be delivered to your server to check the connection between systems.</p>
<h3 id='events-test-event-request'>Request</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Format</th>
</tr>
</thead><tbody>
<tr>
<td>callback_url</td>
<td>URL of your server</td>
<td>String</td>
</tr>
</tbody></table>
<h3 id='events-test-event-response'>Response</h3>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Format</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>Status of test notification delivery</td>
<td>String</td>
</tr>
<tr>
<td>code</td>
<td>HTTP status code we have received from your server</td>
<td>Integer</td>
</tr>
<tr>
<td>elapsed</td>
<td>Time taken to deliver notification, in ms</td>
<td>Integer</td>
</tr>
</tbody></table>
<h2 id='events-transfer-status-change-event'>Transfer status change event</h2>
<blockquote>
<p>Example event:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"subscriptionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abcde123-abcd-abcd-abcd-abcde1234567"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"profileId"</span><span class="p">:</span><span class="w"> </span><span class="mi">123456</span><span class="p">,</span><span class="w">
  </span><span class="s2">"resourceId"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"outgoing_payment_sent"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"eventTime"</span><span class="p">:</span><span class="w"> </span><span class="mi">1481713589566</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='events-transfer-status-change-event-event'>Event</h3>
<p>Event will be triggered every time transfer status is updated.</p>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Format</th>
</tr>
</thead><tbody>
<tr>
<td>subscriptionId</td>
<td>ID of subscription that triggers this notification</td>
<td>String</td>
</tr>
<tr>
<td>profileId</td>
<td>ID of the profile that owns the resource</td>
<td>Integer</td>
</tr>
<tr>
<td>resourceId</td>
<td>ID of the resource that got updated</td>
<td>Integer</td>
</tr>
<tr>
<td>status</td>
<td>New status of the resource, possible values are same as <a href="#transferwise-payouts-guide-track-transfer-status">transfer statuses</a></td>
<td>String</td>
</tr>
<tr>
<td>eventTime</td>
<td>Timestamp when update happened</td>
<td>Timestamp</td>
</tr>
</tbody></table>
<h2 id='events-balance-deposit-event'>Balance deposit event</h2>
<blockquote>
<p>Example event:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"subscriptionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abcde123-abcd-abcd-abcd-abcde1234567"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"profileId"</span><span class="p">:</span><span class="w"> </span><span class="mi">123456</span><span class="p">,</span><span class="w">
  </span><span class="s2">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w">
  </span><span class="s2">"currency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GBP"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"eventType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"balance-deposit-received"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='events-balance-deposit-event-event'>Event</h3>
<p>Event will be triggered every time balance is debited.</p>

<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
<th>Format</th>
</tr>
</thead><tbody>
<tr>
<td>subscriptionId</td>
<td>ID of subscription that triggers this notification</td>
<td>String</td>
</tr>
<tr>
<td>profileId</td>
<td>ID of the profile that owns the balance</td>
<td>Integer</td>
</tr>
<tr>
<td>amount</td>
<td>Deposit amount</td>
<td>Integer</td>
</tr>
<tr>
<td>currency</td>
<td>Currency of the balance that got updated</td>
<td>String</td>
</tr>
<tr>
<td>eventType</td>
<td>Type of update</td>
<td>String</td>
</tr>
</tbody></table>
